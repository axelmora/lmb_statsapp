---
title: "Custom Report"
output: pdf_document
params:
  df: NA
  include_chart: TRUE
  watermark: "LMB Analytics | Axel Mora | 2025-09-18"
  sort_field: NA
  sort_order: NA
  source: "Player Stats"
  fields: !r c()
  year: NULL
  team: NULL
  player: NULL
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(ggplot2)
library(dplyr)
library(knitr)
library(kableExtra)
```

# Report Overview

**Source Data:** `r params$source`

**Selected Fields:** `r if(length(params$fields) > 0) paste(params$fields, collapse = ", ") else "All Fields"`

**Year:** `r if(!is.null(params$year)) params$year else "All Years"`

**Team:** `r if(!is.null(params$team)) params$team else "All Teams"`

**Player:** `r if(!is.null(params$player)) params$player else "All Players"`

**Sorted by:** `r if(!is.na(params$sort_field) & !is.na(params$sort_order)) paste(params$sort_field, params$sort_order) else "None"`

**Records Displayed:** `r if(!is.null(params$df)) nrow(params$df) else 0`

---

# Data Table
```{r table}
if (!is.null(params$df)) {
  kable(params$df, caption = "Filtered and Sorted Data") %>%
    kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed", "responsive")) %>%
    row_spec(0, bold = TRUE, background = "#002D72", color = "white") # MLB blue
} else {
  cat("No data available for the selected filters.")
}
```

---

# Visualization
```{r chart}
if (params$include_chart && !is.null(params$df)) {
  num_cols <- params$df %>% select(where(is.numeric))
  if (ncol(num_cols) >= 2) {
    ggplot(params$df, aes(x = num_cols[[1]], y = num_cols[[2]])) +
      geom_point(color = "#BA0C2F", size = 3) +  # MLB red
      theme_minimal(base_size = 14) +
      labs(title = "",
           x = names(num_cols)[1], y = names(num_cols)[2])
  }
}
```

---


```{r footer, results='asis', echo=FALSE}
cat("\n\n")
cat("\
\
")
cat("\\begin{center}")
cat("\\textbf{Generated by LMB Stats App} \\\\")
cat("Author: Axel Mora \\\\")
cat("Date: ", Sys.Date(), " \\\\")
cat("\\end{center}")
```
