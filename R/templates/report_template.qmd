---
title: "Custom Report"
format: pdf
params:
  df: NULL
  include_chart: false
  chart_path: NULL
  watermark: "LMB Analytics"
  source: NULL
  fields: NULL
  year: NULL
  team: NULL
  player: NULL
  sort_field: NULL
  sort_order: NULL
---

```{r setup,include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(ggplot2)
library(dplyr)
library(knitr)
library(kableExtra)
```

# Report Overview

**Source Data:** `r params$source`
**Selected Fields:** `r if(length(params$fields) > 0) paste(params$fields, collapse = ", ") else "All Fields"`
**Year:** `r if(!is.null(params$year)) params$year else "All Years"`
**Team:** `r if(!is.null(params$team)) params$team else "All Teams"`
**Player:** `r if(!is.null(params$player)) params$player else "All Players"`
**Sorted by:** `r if(!is.na(params$sort_field) & !is.na(params$sort_order)) paste(params$sort_field, params$sort_order) else "None"`
**Records Displayed:** `r if(!is.null(params$df)) nrow(params$df) else 0`

---

# Data Table
```{r table}
if (!is.null(params$df)) {
  df <- as.data.frame(params$df)  # ensure it's a data.frame
  kable(df, caption = "Filtered and Sorted Data") %>%
    kable_styling(
      full_width = FALSE,
      bootstrap_options = c("striped", "hover", "condensed", "responsive")
    ) %>%
    row_spec(0, bold = TRUE, background = "#002D72", color = "white")
} else {
  cat("No data available for the selected filters.")
}
```

---

# Visualization
```{r chart}
  if (isTRUE(params$include_chart) && !is.null(params$chart_path)) {
    knitr::include_graphics(params$chart_path)
      } else {
        cat("No chart included.")
      }
```

---


```{r footer, results='asis', echo=FALSE}
cat("\n\n")
cat("\
\
")
cat("\\begin{center}")
cat("\\textbf{Generated by LMB Stats App} \\\\")
cat("Author: Axel Mora \\\\")
cat("Date: ", Sys.Date(), " \\\\")
cat("\\end{center}")
```
